<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Visual Block Editor (Lit)</title>
    <style>
      html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      .root { display:flex; height:100%; width:100%; }
    </style>
  </head>
  <body>
    <div class="root">
      <visual-block-data id="data-provider" base-url="https://us-central1-lozzuck.cloudfunctions.net/blocks">
        <visual-block-editor></visual-block-editor>
      </visual-block-data>
    </div>

    <!-- Use the built IIFE bundle for broader compatibility -->
    <script src="../dist/iife/visual-block-editor.iife.js"></script>

    <script>
      // The IIFE bundle is available on window.VisualBlockEditor
      if (window.VisualBlockEditor && typeof window.VisualBlockEditor.registerVisualBlockEditor === 'function') {
        window.VisualBlockEditor.registerVisualBlockEditor();
      }

      function configureGeminiClient(apiKey) {
        const dataProvider = document.getElementById('data-provider');
        if (dataProvider && window.VisualBlockEditor && window.VisualBlockEditor.createGeminiClient) {
          const geminiClient = window.VisualBlockEditor.createGeminiClient(apiKey);
          dataProvider.aiClient = geminiClient;
          console.log('Gemini AI Client configured.');
        } else {
          console.error('Could not configure Gemini client. Components not found.');
        }
      }

      customElements.whenDefined('visual-block-data').then(() => {
        // --- IMPORTANT ---
        // Replace this with your actual Google AI API key
        const GEMINI_API_KEY = 'AIzaSyCAz2tpYB4CIN_I89u8083PI7Yextik4rU'; 
        
        if (GEMINI_API_KEY === 'GEMINI_API_KEY') {
          console.warn('Using a placeholder API key for Gemini. Please replace it in demo/index.html.');
          alert('Please set your Gemini API key in demo/index.html to enable AI features.');
        }
        
        configureGeminiClient(GEMINI_API_KEY);
      });
    </script>
  </body>
</html>
